// {{name}} struct
//
// This mimics the Rust tuple type structure by constructing a
// field for each index in the tuple.
type {{name}} struct {
    {{#each fields}}
    V{{this.variable}} {{this.type_name}}
    {{/each}}
}

func (result *{{name}}) UnmarshalJSON(b []byte) error {
    var jsonFields []json.RawMessage
    json.Unmarshal(b, &jsonFields)

    if (len(jsonFields) != {{len fields}}) {
        return fmt.Errorf("incorrect length for tuple. Expected %d, got %#v", {{len fields}}, jsonFields)
    }

    var err error
    {{#each fields}}
    {{#if (isEnum this.variant) }}
    v{{this.variable}}, err := Deserialize{{this.type_name}}(jsonFields[{{this.variable}}])
    if err != nil {
        return err
    }
    result.V{{this.variable}} = *v{{this.variable}}
    {{else}}
    err = json.Unmarshal(jsonFields[{{this.variable}}], &result.V{{this.variable}})
    if err != nil {
        return err
    }
    {{/if}}
    {{/each}}
    return nil
}

func (variant {{name}}) MarshalJSON() ([]byte, error) {
    fieldArray := []interface{}{
        {{#each fields}}
        variant.V{{this.variable}},
        {{/each}}
    }

    return json.Marshal(fieldArray)
}
