{"max_depth":9,"depths":[0,1,2,3,4,5,5,6,7,8,7,8,6,7,7,8,6,7,8,8,9,7,8],"events":[{"Query":{"term":{"value":{"Call":{"name":"allow","args":[{"value":{"ExternalInstance":{"instance_id":14,"constructor":null,"repr":null}}},{"value":{"String":"invite"}},{"value":{"ExternalInstance":{"instance_id":15,"constructor":null,"repr":null}}}],"kwargs":null}}}}},{"Rule":{"rule":{"name":"allow","params":[{"parameter":{"value":{"Variable":"actor"}},"specializer":null},{"parameter":{"value":{"Variable":"action"}},"specializer":null},{"parameter":{"value":{"Variable":"resource"}},"specializer":null}],"body":{"value":{"Expression":{"operator":"And","args":[{"value":{"Call":{"name":"has_permission","args":[{"value":{"Variable":"actor"}},{"value":{"Variable":"action"}},{"value":{"Variable":"resource"}}],"kwargs":null}}}]}}},"required":false}}},{"Query":{"term":{"value":{"Call":{"name":"has_permission","args":[{"value":{"Variable":"_actor_9"}},{"value":{"Variable":"_action_10"}},{"value":{"Variable":"_resource_11"}}],"kwargs":null}}}}},{"Rule":{"rule":{"name":"has_permission","params":[{"parameter":{"value":{"Variable":"actor"}},"specializer":{"value":{"Pattern":{"Instance":{"tag":"Actor","fields":{"fields":{}}}}}}},{"parameter":{"value":{"String":"invite"}},"specializer":null},{"parameter":{"value":{"Variable":"organization"}},"specializer":{"value":{"Pattern":{"Instance":{"tag":"Organization","fields":{"fields":{}}}}}}}],"body":{"value":{"Expression":{"operator":"And","args":[{"value":{"Call":{"name":"has_role","args":[{"value":{"Variable":"actor"}},{"value":{"String":"owner"}},{"value":{"Variable":"organization"}}],"kwargs":null}}}]}}},"required":false}}},{"Query":{"term":{"value":{"Call":{"name":"has_role","args":[{"value":{"Variable":"_actor_16"}},{"value":{"String":"owner"}},{"value":{"Variable":"_organization_17"}}],"kwargs":null}}}}},{"Rule":{"rule":{"name":"has_role","params":[{"parameter":{"value":{"Variable":"user"}},"specializer":{"value":{"Pattern":{"Instance":{"tag":"User","fields":{"fields":{}}}}}}},{"parameter":{"value":{"Variable":"name"}},"specializer":{"value":{"Pattern":{"Instance":{"tag":"String","fields":{"fields":{}}}}}}},{"parameter":{"value":{"Variable":"org"}},"specializer":{"value":{"Pattern":{"Instance":{"tag":"Organization","fields":{"fields":{}}}}}}}],"body":{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"user"}},{"value":{"String":"org_roles"}},{"value":{"Variable":"_value_1"}}]}}},{"value":{"Expression":{"operator":"In","args":[{"value":{"Variable":"role"}},{"value":{"Variable":"_value_1"}}]}}}]}}},{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"_value_2"}},{"value":{"Variable":"name"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"role"}},{"value":{"String":"role"}},{"value":{"Variable":"_value_2"}}]}}}]}}},{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"_value_3"}},{"value":{"Variable":"_value_4"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"role"}},{"value":{"String":"org_name"}},{"value":{"Variable":"_value_3"}}]}}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"org"}},{"value":{"String":"name"}},{"value":{"Variable":"_value_4"}}]}}}]}}}]}}},"required":false}}},{"Query":{"term":{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_user_31"}},{"value":{"String":"org_roles"}},{"value":{"Variable":"__value_1_34"}}]}}},{"value":{"Expression":{"operator":"In","args":[{"value":{"Variable":"_role_35"}},{"value":{"Variable":"__value_1_34"}}]}}}]}}},{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_2_36"}},{"value":{"Variable":"_name_32"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"role"}},{"value":{"Variable":"__value_2_36"}}]}}}]}}},{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_3_37"}},{"value":{"Variable":"__value_4_38"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"org_name"}},{"value":{"Variable":"__value_3_37"}}]}}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_org_33"}},{"value":{"String":"name"}},{"value":{"Variable":"__value_4_38"}}]}}}]}}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_user_31"}},{"value":{"String":"org_roles"}},{"value":{"Variable":"__value_1_34"}}]}}},{"value":{"Expression":{"operator":"In","args":[{"value":{"Variable":"_role_35"}},{"value":{"Variable":"__value_1_34"}}]}}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_user_31"}},{"value":{"String":"org_roles"}},{"value":{"Variable":"__value_1_34"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"ExternalInstance":{"instance_id":14,"constructor":null,"repr":null}}},{"value":{"String":"org_roles"}},{"value":{"Variable":"__value_1_34"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"In","args":[{"value":{"Variable":"_role_35"}},{"value":{"Variable":"__value_1_34"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"In","args":[{"value":{"Variable":"_role_35"}},{"value":{"List":[{"value":{"Dictionary":{"fields":{"org_name":{"value":{"String":"osohq"}},"role":{"value":{"String":"owner"}}}}}}]}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_2_36"}},{"value":{"Variable":"_name_32"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"role"}},{"value":{"Variable":"__value_2_36"}}]}}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_2_36"}},{"value":{"Variable":"_name_32"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"role"}},{"value":{"Variable":"__value_2_36"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Dictionary":{"fields":{"org_name":{"value":{"String":"osohq"}},"role":{"value":{"String":"owner"}}}}}},{"value":{"String":"role"}},{"value":{"Variable":"__value_2_36"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_3_37"}},{"value":{"Variable":"__value_4_38"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"org_name"}},{"value":{"Variable":"__value_3_37"}}]}}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_org_33"}},{"value":{"String":"name"}},{"value":{"Variable":"__value_4_38"}}]}}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"And","args":[{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_3_37"}},{"value":{"Variable":"__value_4_38"}}]}}},{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"org_name"}},{"value":{"Variable":"__value_3_37"}}]}}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Unify","args":[{"value":{"Variable":"__value_3_37"}},{"value":{"Variable":"__value_4_38"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_role_35"}},{"value":{"String":"org_name"}},{"value":{"Variable":"__value_3_37"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Dictionary":{"fields":{"org_name":{"value":{"String":"osohq"}},"role":{"value":{"String":"owner"}}}}}},{"value":{"String":"org_name"}},{"value":{"Variable":"__value_3_37"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"Variable":"_org_33"}},{"value":{"String":"name"}},{"value":{"Variable":"__value_4_38"}}]}}}}},{"Query":{"term":{"value":{"Expression":{"operator":"Dot","args":[{"value":{"ExternalInstance":{"instance_id":15,"constructor":null,"repr":null}}},{"value":{"String":"name"}},{"value":{"Variable":"__value_4_38"}}]}}}}}]}